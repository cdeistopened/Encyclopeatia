# Ray Peat EncycloPEATia - Project Handoff
## Date: 2026-01-03
## Current Status: Partially Restored with Mixed UI Systems

## Executive Summary
The Ray Peat EncycloPEATia project has been restored from commit 255893f with Railway deployment fixes applied. However, the codebase contains multiple conflicting design systems that need consolidation. The core functionality works, but UI consistency is a major issue.

## What Works ‚úÖ
1. **Deployment Infrastructure**
   - Railway deployment with Node.js >=20.9.0
   - FastAPI backend for future RAG integration
   - Next.js 16 with proper async params handling

2. **Core Features**
   - Episode browsing with filtering by show/year
   - Audio playback with persistent player
   - Raw/Polished transcript toggle (polished as default)
   - Show listings with external links
   - Ask Peat email interface (AI responses are placeholder)

3. **Data**
   - 248 total episodes in episodes.json
   - 146 Ask the Herb Doctor episodes
   - 201 episodes with audio URLs (81%)
   - 47 episodes without audio (mostly "Unknown" show)

## Major Issues to Fix üîß

### 1. **Mixed Design Systems**
The codebase has THREE different design systems competing:

#### a) EncycloPEATia Neobrutalist (Current Standard) ‚úÖ
- **Where**: Ask Peat, Podcasts, Episode pages
- **Colors**: Warm palette (#FFD93D primary, #6B5B95 accent)
- **Style**: Hard shadows, bold borders, Material Design icons
- **CSS**: Proper Tailwind classes in globals.css

#### b) Windows 95 Theme ‚ùå
- **Where**: `/topics` page (ENTIRE PAGE)
- **Issues**: 
  - Custom Win95Button and Win95Window components
  - Hardcoded colors (#000080, #c0c0c0, #808080)
  - MS Sans Serif font references
  - Teal background (#008080)

#### c) Undefined CSS Variables ‚ùå
- **Where**: Sidebar.tsx, EpisodeTable.tsx, layout.tsx
- **Issues**:
  - Using `var(--background)`, `var(--foreground)`, etc.
  - These variables don't exist in globals.css
  - Should use `var(--color-paper)`, `var(--color-ink)`, etc.

### 2. **File Organization Mess**
```
app/
‚îú‚îÄ‚îÄ frontend/          # Next.js app
‚îú‚îÄ‚îÄ backend/           # FastAPI (mostly placeholder)
‚îú‚îÄ‚îÄ transcripts/       # 770+ transcript files (outside frontend)
‚îú‚îÄ‚îÄ newsletters/       # Ray Peat newsletters
‚îú‚îÄ‚îÄ articles/          # raypeat.com articles  
‚îú‚îÄ‚îÄ encyclopedia/      # Source sheets
‚îú‚îÄ‚îÄ page copy.tsx      # BACKUP FILE (should be deleted)
‚îî‚îÄ‚îÄ .env 2            # BACKUP FILES (should be deleted)
```

### 3. **Missing Functionality**
- RAG search system (backend exists but not implemented)
- Encyclopedia section (route exists, no content)
- Topics page (has Win95 UI, needs complete rebuild)
- Newsletter/Article integration

### 4. **Data Issues**
- 47 episodes missing audio URLs
- "Unknown" show category has 29 episodes
- Some shows have # as external URL (placeholder)

## Immediate Cleanup Tasks

### 1. **Remove Backup Files**
```bash
rm "page copy.tsx"
rm ".env 2"
rm "backend/rag/.env 2"
```

### 2. **Fix CSS Variables**
Update these files to use correct variables:
- `src/components/Sidebar.tsx`
- `src/components/EpisodeTable.tsx` 
- `src/app/layout.tsx`

Replace:
- `var(--background)` ‚Üí `bg-paper` class
- `var(--foreground)` ‚Üí `text-ink` class
- `var(--border)` ‚Üí `border-ink` class
- `var(--muted)` ‚Üí `text-ink-muted` class

### 3. **Rebuild Topics Page**
The entire `/topics` page needs to be rebuilt with EncycloPEATia design.

### 4. **Create Encyclopedia Page**
Currently just a placeholder - needs actual content browser.

## Project Architecture

### Frontend Routes
- `/` - Homepage (needs design)
- `/podcasts` - Browse shows & episodes ‚úÖ
- `/episode/[...slug]` - Episode detail with transcript ‚úÖ
- `/ask` - AI Q&A interface ‚úÖ
- `/encyclopedia` - Placeholder (needs implementation)
- `/topics` - Win95 design (needs rebuild)

### API Routes  
- `/api/ask` - Placeholder AI endpoint
- `/api/episode/[slug]` - Fetches episode + transcript ‚úÖ
- `/api/topics/*` - Topics system (uses Win95 UI)

### Key Components
- `AudioPlayer.tsx` - Global audio player ‚úÖ
- `PlayerContext.tsx` - Audio state management ‚úÖ
- `Sidebar.tsx` - Has CSS variable issues
- `EpisodeTable.tsx` - Has CSS variable issues

## Design System Reference

### Colors (from globals.css)
```css
--color-primary: #FFD93D      /* Yellow */
--color-accent: #6B5B95       /* Purple */
--color-paper: #FFF8E1        /* Off-white */
--color-surface: #FFFEF7      /* Lighter off-white */
--color-ink: #2C2C2C          /* Dark gray */
--color-ink-muted: #6B6B6B    /* Medium gray */
```

### Components
- Borders: 2px solid with border-ink
- Shadows: shadow-hard (4px offset)
- Buttons: Bold uppercase font-mono text
- Icons: Material Design Symbols

## Next Steps Priority

1. **Clean up CSS variables** - Quick fix, high impact
2. **Delete backup files** - Quick cleanup
3. **Rebuild topics page** - Major task but isolated
4. **Implement encyclopedia** - New feature
5. **Hook up real RAG system** - Backend integration

## Deployment Notes
- GitHub: https://github.com/cdeistopened/Encyclopeatia
- Railway: Auto-deploys from main branch
- No env vars needed for basic frontend

## Known Quirks
- Episode slugs include full path (e.g., "ask-the-herb-doctor/polished/2022-11-18...")
- Some transcript files may be missing
- Audio player persists across navigation (feature, not bug)

## Contact
Created during session with user frustration about incomplete restoration.
The goal was clean EncycloPEATia design everywhere - we're about 75% there.